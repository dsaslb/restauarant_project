<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-active {
            background-color: #27ae60;
            box-shadow: 0 0 10px rgba(39, 174, 96, 0.5);
        }

        .status-inactive {
            background-color: #e74c3c;
            box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .card-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #2c3e50;
        }

        .card-subtitle {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .metric {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .metric-value {
            font-size: 2em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9em;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .plugin-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .plugin-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            border-left: 4px solid #3498db;
            transition: all 0.3s ease;
        }

        .plugin-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .plugin-info {
            flex: 1;
        }

        .plugin-name {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .plugin-stats {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .plugin-status {
            text-align: right;
        }

        .success-rate {
            font-size: 1.2em;
            font-weight: 600;
            color: #27ae60;
        }

        .error-rate {
            color: #e74c3c;
        }

        .alert-list {
            max-height: 300px;
            overflow-y: auto;
        }

        .alert-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 4px solid;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }

        .alert-critical {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #fdf2f2 0%, #fde8e8 100%);
        }

        .alert-high {
            border-left-color: #f39c12;
            background: linear-gradient(135deg, #fef7ed 0%, #fdebd0 100%);
        }

        .alert-medium {
            border-left-color: #f1c40f;
            background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
        }

        .alert-low {
            border-left-color: #3498db;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
        }

        .alert-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .alert-severity {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8em;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
        }

        .severity-critical {
            background-color: #e74c3c;
        }

        .severity-high {
            background-color: #f39c12;
        }

        .severity-medium {
            background-color: #f1c40f;
            color: #333;
        }

        .severity-low {
            background-color: #3498db;
        }

        .alert-message {
            font-size: 0.9em;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .alert-time {
            font-size: 0.8em;
            color: #7f8c8d;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        .refresh-button {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #ecf0f1;
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid #27ae60;
        }

        .notification.error {
            border-left: 4px solid #e74c3c;
        }

        .notification.warning {
            border-left: 4px solid #f39c12;
        }

        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .metric-grid {
                grid-template-columns: 1fr;
            }

            .container {
                padding: 10px;
            }

            .card {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîå ÌîåÎü¨Í∑∏Ïù∏ Î™®ÎãàÌÑ∞ÎßÅ ÎåÄÏãúÎ≥¥Îìú</h1>
            <p>Ïã§ÏãúÍ∞Ñ ÌîåÎü¨Í∑∏Ïù∏ ÏÉÅÌÉú, ÏÑ±Îä•, ÏïåÎ¶ºÏùÑ Î™®ÎãàÌÑ∞ÎßÅÌï©ÎãàÎã§</p>
            <div style="margin-top: 15px;">
                <span class="status-indicator status-active"></span>
                <span id="connection-status">Ïó∞Í≤∞Îê®</span>
                <button class="refresh-button" onclick="refreshData()">ÏÉàÎ°úÍ≥†Ïπ®</button>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- ÌîåÎü¨Í∑∏Ïù∏ ÏÉÅÌÉú Ïπ¥Îìú -->
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">üìä ÌîåÎü¨Í∑∏Ïù∏ ÏÉÅÌÉú</div>
                        <div class="card-subtitle">Ïã§ÏãúÍ∞Ñ ÌîåÎü¨Í∑∏Ïù∏ Ïã§Ìñâ ÏÉÅÌÉú</div>
                    </div>
                </div>
                <div class="metric-grid">
                    <div class="metric">
                        <div class="metric-value" id="total-plugins">-</div>
                        <div class="metric-label">Ï¥ù ÌîåÎü¨Í∑∏Ïù∏</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="active-plugins">-</div>
                        <div class="metric-label">ÌôúÏÑ± ÌîåÎü¨Í∑∏Ïù∏</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="total-executions">-</div>
                        <div class="metric-label">Ï¥ù Ïã§Ìñâ</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value" id="avg-success-rate">-</div>
                        <div class="metric-label">ÌèâÍ∑† ÏÑ±Í≥µÎ•†</div>
                    </div>
                </div>
                <div class="plugin-list" id="plugin-list">
                    <div class="loading">ÌîåÎü¨Í∑∏Ïù∏ Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</div>
                </div>
            </div>

            <!-- ÏÑ±Îä• Ï∞®Ìä∏ Ïπ¥Îìú -->
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">üìà ÏÑ±Îä• Ï∂îÏù¥</div>
                        <div class="card-subtitle">ÌîåÎü¨Í∑∏Ïù∏ ÏÑ±Îä• Î©îÌä∏Î¶≠</div>
                    </div>
                    <select id="chart-plugin-select" onchange="updateChart()">
                        <option value="">ÌîåÎü¨Í∑∏Ïù∏ ÏÑ†ÌÉù</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="performance-chart"></canvas>
                </div>
            </div>

            <!-- ÏïåÎ¶º Ïπ¥Îìú -->
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">üö® ÌôúÏÑ± ÏïåÎ¶º</div>
                        <div class="card-subtitle">ÏÑ±Îä• Î∞è Ïò§Î•ò ÏïåÎ¶º</div>
                    </div>
                </div>
                <div class="alert-list" id="alert-list">
                    <div class="loading">ÏïåÎ¶ºÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...</div>
                </div>
            </div>

            <!-- Î°úÍ∑∏ Ïπ¥Îìú -->
            <div class="card">
                <div class="card-header">
                    <div>
                        <div class="card-title">üìù ÏµúÍ∑º Î°úÍ∑∏</div>
                        <div class="card-subtitle">ÌîåÎü¨Í∑∏Ïù∏ Ïã§Ìñâ Î°úÍ∑∏</div>
                    </div>
                    <select id="log-plugin-select" onchange="loadLogs()">
                        <option value="">ÌîåÎü¨Í∑∏Ïù∏ ÏÑ†ÌÉù</option>
                    </select>
                </div>
                <div class="plugin-list" id="log-list">
                    <div class="loading">Î°úÍ∑∏Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏïåÎ¶º ÌëúÏãú ÏòÅÏó≠ -->
    <div id="notification-area"></div>

    <script>
        let ws = null;
        let performanceChart = null;
        let refreshInterval = null;

        // Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', function() {
            initializeWebSocket();
            loadInitialData();
            startAutoRefresh();
        });

        // ÏõπÏÜåÏºì Ï¥àÍ∏∞Ìôî
        function initializeWebSocket() {
            {% if enable_websocket %}
            try {
                ws = new WebSocket(`ws://${window.location.host}/ws`);
                
                ws.onopen = function() {
                    console.log('ÏõπÏÜåÏºì Ïó∞Í≤∞Îê®');
                    updateConnectionStatus(true);
                    ws.send(JSON.stringify({type: 'subscribe'}));
                };
                
                ws.onmessage = function(event) {
                    const data = JSON.parse(event.data);
                    handleWebSocketMessage(data);
                };
                
                ws.onclose = function() {
                    console.log('ÏõπÏÜåÏºì Ïó∞Í≤∞ ÎÅäÏñ¥Ïßê');
                    updateConnectionStatus(false);
                    // Ïû¨Ïó∞Í≤∞ ÏãúÎèÑ
                    setTimeout(initializeWebSocket, 5000);
                };
                
                ws.onerror = function(error) {
                    console.error('ÏõπÏÜåÏºì Ïò§Î•ò:', error);
                    updateConnectionStatus(false);
                };
            } catch (error) {
                console.error('ÏõπÏÜåÏºì Ï¥àÍ∏∞Ìôî Ïã§Ìå®:', error);
                updateConnectionStatus(false);
            }
            {% endif %}
        }

        // Ïó∞Í≤∞ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updateConnectionStatus(connected) {
            const statusElement = document.getElementById('connection-status');
            const indicator = document.querySelector('.status-indicator');
            
            if (connected) {
                statusElement.textContent = 'Ïó∞Í≤∞Îê®';
                indicator.className = 'status-indicator status-active';
            } else {
                statusElement.textContent = 'Ïó∞Í≤∞ ÎÅäÏñ¥Ïßê';
                indicator.className = 'status-indicator status-inactive';
            }
        }

        // ÏõπÏÜåÏºì Î©îÏãúÏßÄ Ï≤òÎ¶¨
        function handleWebSocketMessage(data) {
            switch (data.type) {
                case 'status_update':
                    updatePluginStatus(data.data);
                    break;
                case 'alert':
                    handleNewAlert(data.data);
                    break;
                default:
                    console.log('Ïïå Ïàò ÏóÜÎäî Î©îÏãúÏßÄ ÌÉÄÏûÖ:', data.type);
            }
        }

        // Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
        async function loadInitialData() {
            try {
                await Promise.all([
                    loadPluginStatus(),
                    loadAlerts(),
                    loadLogs()
                ]);
            } catch (error) {
                console.error('Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
                showNotification('Îç∞Ïù¥ÌÑ∞ Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§', 'error');
            }
        }

        // ÌîåÎü¨Í∑∏Ïù∏ ÏÉÅÌÉú Î°úÎìú
        async function loadPluginStatus() {
            try {
                const response = await axios.get('/api/status');
                if (response.data.status === 'success') {
                    updatePluginStatus(response.data);
                }
            } catch (error) {
                console.error('ÌîåÎü¨Í∑∏Ïù∏ ÏÉÅÌÉú Î°úÎìú Ïã§Ìå®:', error);
            }
        }

        // ÌîåÎü¨Í∑∏Ïù∏ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
        function updatePluginStatus(data) {
            const plugins = data.plugins || [];
            
            // ÏöîÏïΩ Î©îÌä∏Î¶≠ ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('total-plugins').textContent = plugins.length;
            document.getElementById('active-plugins').textContent = plugins.filter(p => p.is_active).length;
            
            const totalExecutions = plugins.reduce((sum, p) => sum + p.execution_count, 0);
            document.getElementById('total-executions').textContent = totalExecutions.toLocaleString();
            
            const avgSuccessRate = plugins.length > 0 ? 
                (plugins.reduce((sum, p) => sum + p.success_rate, 0) / plugins.length * 100).toFixed(1) : 0;
            document.getElementById('avg-success-rate').textContent = avgSuccessRate + '%';
            
            // ÌîåÎü¨Í∑∏Ïù∏ Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
            updatePluginList(plugins);
            
            // Ï∞®Ìä∏ ÌîåÎü¨Í∑∏Ïù∏ ÏÑ†ÌÉù ÏòµÏÖò ÏóÖÎç∞Ïù¥Ìä∏
            updateChartPluginOptions(plugins);
        }

        // ÌîåÎü¨Í∑∏Ïù∏ Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
        function updatePluginList(plugins) {
            const container = document.getElementById('plugin-list');
            
            if (plugins.length === 0) {
                container.innerHTML = '<div class="loading">ÌîåÎü¨Í∑∏Ïù∏Ïù¥ ÏóÜÏäµÎãàÎã§</div>';
                return;
            }
            
            container.innerHTML = plugins.map(plugin => `
                <div class="plugin-item">
                    <div class="plugin-info">
                        <div class="plugin-name">${plugin.plugin_id}</div>
                        <div class="plugin-stats">
                            Ïã§Ìñâ: ${plugin.execution_count}Ìöå | 
                            ÌèâÍ∑† ÏãúÍ∞Ñ: ${plugin.avg_execution_time.toFixed(2)}Ï¥à |
                            Î©îÎ™®Î¶¨: ${plugin.avg_memory_usage.toFixed(1)}MB
                        </div>
                    </div>
                    <div class="plugin-status">
                        <div class="success-rate">${(plugin.success_rate * 100).toFixed(1)}%</div>
                        <div class="plugin-stats">Ïò§Î•ò: ${plugin.error_count}Ìöå</div>
                    </div>
                </div>
            `).join('');
        }

        // Ï∞®Ìä∏ ÌîåÎü¨Í∑∏Ïù∏ ÏòµÏÖò ÏóÖÎç∞Ïù¥Ìä∏
        function updateChartPluginOptions(plugins) {
            const select = document.getElementById('chart-plugin-select');
            const currentValue = select.value;
            
            select.innerHTML = '<option value="">ÌîåÎü¨Í∑∏Ïù∏ ÏÑ†ÌÉù</option>' +
                plugins.map(plugin => `<option value="${plugin.plugin_id}">${plugin.plugin_id}</option>`).join('');
            
            if (currentValue) {
                select.value = currentValue;
            }
        }

        // ÏïåÎ¶º Î°úÎìú
        async function loadAlerts() {
            try {
                const response = await axios.get('/api/alerts');
                if (response.data.status === 'success') {
                    updateAlertList(response.data.data);
                }
            } catch (error) {
                console.error('ÏïåÎ¶º Î°úÎìú Ïã§Ìå®:', error);
            }
        }

        // ÏïåÎ¶º Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
        function updateAlertList(alerts) {
            const container = document.getElementById('alert-list');
            
            if (alerts.length === 0) {
                container.innerHTML = '<div class="loading">ÌôúÏÑ± ÏïåÎ¶ºÏù¥ ÏóÜÏäµÎãàÎã§</div>';
                return;
            }
            
            container.innerHTML = alerts.map(alert => `
                <div class="alert-item alert-${alert.severity}">
                    <div class="alert-header">
                        <span class="alert-severity severity-${alert.severity}">${alert.severity}</span>
                        <small>${formatTime(alert.timestamp)}</small>
                    </div>
                    <div class="alert-message">${alert.message}</div>
                    <div class="alert-time">${alert.plugin_id} | ÏûÑÍ≥ÑÍ∞í: ${alert.threshold} | ÌòÑÏû¨Í∞í: ${alert.current_value}</div>
                </div>
            `).join('');
        }

        // ÏÉà ÏïåÎ¶º Ï≤òÎ¶¨
        function handleNewAlert(alert) {
            showNotification(alert.message, alert.severity);
            loadAlerts(); // ÏïåÎ¶º Î™©Î°ù ÏÉàÎ°úÍ≥†Ïπ®
        }

        // Î°úÍ∑∏ Î°úÎìú
        async function loadLogs() {
            const pluginId = document.getElementById('log-plugin-select').value;
            if (!pluginId) {
                document.getElementById('log-list').innerHTML = '<div class="loading">ÌîåÎü¨Í∑∏Ïù∏ÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</div>';
                return;
            }
            
            try {
                const response = await axios.get(`/api/logs/${pluginId}?limit=20`);
                if (response.data.status === 'success') {
                    updateLogList(response.data.data);
                }
            } catch (error) {
                console.error('Î°úÍ∑∏ Î°úÎìú Ïã§Ìå®:', error);
            }
        }

        // Î°úÍ∑∏ Î™©Î°ù ÏóÖÎç∞Ïù¥Ìä∏
        function updateLogList(logs) {
            const container = document.getElementById('log-list');
            
            if (logs.length === 0) {
                container.innerHTML = '<div class="loading">Î°úÍ∑∏Í∞Ä ÏóÜÏäµÎãàÎã§</div>';
                return;
            }
            
            container.innerHTML = logs.map(log => `
                <div class="plugin-item">
                    <div class="plugin-info">
                        <div class="plugin-name">[${log.level}] ${log.message}</div>
                        <div class="plugin-stats">
                            ${formatTime(log.timestamp)} | ${log.module}.${log.function}:${log.line_number}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Ï∞®Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
        async function updateChart() {
            const pluginId = document.getElementById('chart-plugin-select').value;
            if (!pluginId) {
                if (performanceChart) {
                    performanceChart.destroy();
                    performanceChart = null;
                }
                return;
            }
            
            try {
                const response = await axios.get(`/api/performance/${pluginId}?hours=24`);
                if (response.data.status === 'success') {
                    createPerformanceChart(pluginId, response.data.data);
                }
            } catch (error) {
                console.error('Ï∞®Ìä∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
            }
        }

        // ÏÑ±Îä• Ï∞®Ìä∏ ÏÉùÏÑ±
        function createPerformanceChart(pluginId, data) {
            const ctx = document.getElementById('performance-chart').getContext('2d');
            
            if (performanceChart) {
                performanceChart.destroy();
            }
            
            const chartData = {
                labels: data.map(d => new Date(d.timestamp).toLocaleTimeString()),
                datasets: [
                    {
                        label: 'Ïã§Ìñâ ÏãúÍ∞Ñ (Ï¥à)',
                        data: data.map(d => d.execution_time),
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        tension: 0.4
                    },
                    {
                        label: 'Î©îÎ™®Î¶¨ ÏÇ¨Ïö©Îüâ (MB)',
                        data: data.map(d => d.memory_usage),
                        borderColor: '#e74c3c',
                        backgroundColor: 'rgba(231, 76, 60, 0.1)',
                        tension: 0.4
                    }
                ]
            };
            
            performanceChart = new Chart(ctx, {
                type: 'line',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `${pluginId} ÏÑ±Îä• Ï∂îÏù¥`
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // ÏûêÎèô ÏÉàÎ°úÍ≥†Ïπ® ÏãúÏûë
        function startAutoRefresh() {
            refreshInterval = setInterval(() => {
                loadPluginStatus();
                loadAlerts();
            }, {{ refresh_interval }});
        }

        // ÏàòÎèô ÏÉàÎ°úÍ≥†Ïπ®
        function refreshData() {
            loadInitialData();
            showNotification('Îç∞Ïù¥ÌÑ∞Í∞Ä ÏÉàÎ°úÍ≥†Ïπ®ÎêòÏóàÏäµÎãàÎã§', 'success');
        }

        // ÏïåÎ¶º ÌëúÏãú
        function showNotification(message, type = 'info') {
            const notificationArea = document.getElementById('notification-area');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            notificationArea.appendChild(notification);
            
            // Ïï†ÎãàÎ©îÏù¥ÏÖò
            setTimeout(() => notification.classList.add('show'), 100);
            
            // ÏûêÎèô Ï†úÍ±∞
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        // ÏãúÍ∞Ñ Ìè¨Îß∑
        function formatTime(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleString('ko-KR');
        }

        // ÌéòÏù¥ÏßÄ Ïñ∏Î°úÎìú Ïãú Ï†ïÎ¶¨
        window.addEventListener('beforeunload', function() {
            if (refreshInterval) {
                clearInterval(refreshInterval);
            }
            if (ws) {
                ws.close();
            }
        });
    </script>
</body>
</html> 